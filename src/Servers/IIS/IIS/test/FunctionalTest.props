<Project>

  <PropertyGroup>
    <HelixTimeout>00:45:00</HelixTimeout>
  </PropertyGroup>

  <ItemGroup>
    <Compile Include="$(SharedSourceRoot)test\SkipOnHelixAttribute.cs" />

    <Content Include="..\Common.FunctionalTests\AppHostConfig\*.config" CopyToOutputDirectory="PreserveNewest" />
  </ItemGroup>

  <ItemGroup>
    <HelixProjectPlatform Remove="Linux;OSX" />

    <HelixContent Include="..\..\..\tools\update_schema.ps1" />
    <HelixContent Include="..\..\..\tools\UpdateIISExpressCertificate.ps1" />
    <HelixContent Include="..\..\..\AspNetCoreModuleV2\AspNetCore\aspnetcore_schema_v2.xml" />

    <HelixPreCommand Include="call RunPowershell.cmd update_schema.ps1" />
    <HelixPreCommand Include="call RunPowershell.cmd UpdateIISExpressCertificate.ps1" />
  </ItemGroup>

  <Target Name="BuildAssets" AfterTargets="Build">
    <MSBuild Projects="@(ProjectReference)" Targets="PublishTestsAssets" SkipNonexistentTargets="true" BuildInParallel="True" />
  </Target>

  <Target Name="PublishAssets" AfterTargets="Publish">

    <ConvertToAbsolutePath Paths="$(PublishDir)">
      <Output TaskParameter="AbsolutePaths" PropertyName="PublishAbsoluteDir" />
    </ConvertToAbsolutePath>

    <MSBuild Projects="@(ProjectReference)" Targets="PublishTestsAssets" SkipNonexistentTargets="true" BuildInParallel="True" Properties="PublishDir=$(PublishAbsoluteDir)" />
  </Target>

</Project>
